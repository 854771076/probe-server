import{s as e,G as t,H as a,J as l,l as o,o as s,c as i,w as u,i as r,a as d,b as n,t as m,I as c,g as f,E as p}from"./index-34a2c96b.js";import{_ as h}from"./tui-list-cell.cf7c2bc5.js";import{_ as g,r as _}from"./uni-app.es.1c8f1c55.js";import{_ as b}from"./tui-button.f7919236.js";import{_ as w}from"./tui-white-space.45e06eee.js";import{f as v}from"./tui-validation.c5aa0c0a.js";let x=[{name:"email",rule:["required","isEmail"],msg:["请输入邮箱","请输入正确的邮箱"]},{name:"password",rule:["required","minLength:8","maxLength:16"],msg:["请输入密码","密码为8~16位"]},{name:"checkpassword",rule:["required","isSame:password"],msg:["请输入重复密码","密码不一致"]},{name:"code",rule:["required","isNum","minLength:6"],msg:["请输入验证码","请输入正确的验证码"]}];const D=g({created(){},data:()=>({imgCodeUrl:"",imgCookie:"",codeTime:"获取验证码",formData:{email:"",password:"",checkpassword:"",code:""},Interval:null}),methods:{formSubmit:function(t){let a=v.validation(this.formData,x);a?(console.info(this.formData),e({title:a,icon:"none"})):this.submit()},formReset:function(e){},sendCodeCountDown:function(){"获取验证码"===this.codeTime&&(this.codeTime=60,this.Interval=setInterval((()=>{this.codeTime>0?this.codeTime--:(this.codeTime="获取验证码",clearInterval(this.Interval),this.Interval=null)}),1e3))},sendEmailCode:function(o){let s=v.validation(this.formData,[{name:"email",rule:["required","isEmail"],msg:["请输入邮箱","请输入正确的邮箱"]}]);s?e({title:s,icon:"none"}):Boolean(this.Interval)?uni.$tui.toast("频繁操作"):(t({mask:!0}),a({url:uni.$api.emailcode,method:"POST",data:{email:this.formData.email,action:"修改密码"},success:e=>{this.sendCodeCountDown(),l(),uni.$tui.toast("发送成功")},fail:e=>{console.error("Failed to fetch image data:",e),l(),uni.$tui.toast("发送失败")}}))},submit:function(){t({mask:!0}),a({url:uni.$api.foreget,method:"POST",data:this.formData,success:e=>{l(),200!=e.data.code?uni.$tui.toast(e.data.error):o({delta:1,success(){uni.$tui.toast("修改成功")}})},fail:e=>{console.error("Failed to fetch image data:",e),l(),uni.$tui.toast("修改失败")}})}}},[["render",function(e,t,a,l,o,g){const v=r,x=c,D=_(f("tui-list-cell"),h),y=_(f("tui-button"),b),T=_(f("tui-white-space"),w),V=p;return s(),i(v,{class:"container"},{default:u((()=>[d(V,{onSubmit:g.formSubmit,onReset:g.formReset,id:"form"},{default:u((()=>[d(D,{hover:!1},{default:u((()=>[d(v,{class:"tui-line-cell"},{default:u((()=>[d(v,{class:"tui-title"},{default:u((()=>[n("邮箱")])),_:1}),d(x,{"placeholder-class":"tui-phcolor",class:"tui-input",name:"email",placeholder:"请输入邮箱",maxlength:"50",type:"text",modelValue:o.formData.email,"onUpdate:modelValue":t[0]||(t[0]=e=>o.formData.email=e)},null,8,["modelValue"])])),_:1})])),_:1}),d(D,{hover:!1},{default:u((()=>[d(v,{class:"tui-line-cell"},{default:u((()=>[d(v,{class:"tui-title"},{default:u((()=>[n("新密码")])),_:1}),d(x,{password:"","placeholder-class":"tui-phcolor",class:"tui-input",name:"pwd",placeholder:"请输入密码",maxlength:"16",type:"text",modelValue:o.formData.password,"onUpdate:modelValue":t[1]||(t[1]=e=>o.formData.password=e)},null,8,["modelValue"])])),_:1})])),_:1}),d(D,{hover:!1},{default:u((()=>[d(v,{class:"tui-line-cell"},{default:u((()=>[d(v,{class:"tui-title"},{default:u((()=>[n("重复密码")])),_:1}),d(x,{password:"","placeholder-class":"tui-phcolor",class:"tui-input",name:"pwd2",placeholder:"请输入重复密码",maxlength:"16",type:"text",modelValue:o.formData.checkpassword,"onUpdate:modelValue":t[2]||(t[2]=e=>o.formData.checkpassword=e)},null,8,["modelValue"])])),_:1})])),_:1}),d(D,null,{default:u((()=>[d(v,{class:"tui-line-cell"},{default:u((()=>[d(v,{class:"tui-title"},{default:u((()=>[n("验证码")])),_:1}),d(x,{"placeholder-class":"tui-phcolor",class:"tui-input",name:"code",placeholder:"请输入验证码",maxlength:"6",type:"text",modelValue:o.formData.code,"onUpdate:modelValue":t[3]||(t[3]=e=>o.formData.code=e)},null,8,["modelValue"]),d(y,{formType:"button",width:"188rpx",height:"64rpx",background:"#f2f2f2",color:"#5677fc",size:"24",bold:"",radius:"20rpx",onClick:g.sendEmailCode},{default:u((()=>[n(m(o.codeTime),1)])),_:1},8,["onClick"])])),_:1})])),_:1}),d(T,{size:"large"}),d(v,{class:"tui-btn-box"},{default:u((()=>[d(y,{class:"tui-button-primary","hover-class":"tui-button-gray_hover",formType:"submit",type:"green",shape:"circle"},{default:u((()=>[n("修改")])),_:1}),d(T,{size:"large"}),d(y,{class:"tui-button-primary tui-button-gray","hover-class":"tui-button-hover",formType:"reset",shape:"circle",type:"gray"},{default:u((()=>[n("重置")])),_:1})])),_:1})])),_:1},8,["onSubmit","onReset"])])),_:1})}],["__scopeId","data-v-d3dbd63e"]]);export{D as default};
