import{B as t,C as e,s as a,n as i,o as s,c as o,w as r,i as l,d as n,r as c,F as u,a as d,b as h,e as m,g,h as f,t as p,f as y,X as _}from"./index-34a2c96b.js";import{_ as x}from"./uni-tooltip.8e530bdf.js";import{_ as k,r as C}from"./uni-app.es.1c8f1c55.js";import{_ as w,a as b}from"./tui-nomore.ef9d4a5b.js";import{_ as $}from"./tui-white-space.45e06eee.js";const T=k({data:()=>({isShowButton:!1,buttonGroup:[{text:"取消",backgroundColor:"#fff",color:"#000"},{text:"删除",backgroundColor:"#ff0000",color:"#fff"}],header:{line:!0,bgcolor:"#fff"},no_more:!1,menuList:[{title:"时间",type:"sort",value:"desc"},{title:"编辑",type:"click"}],items:[],has_next:!0,pagesize:5e3,nextPage:2,ordering:"-last_update",pullText:"下拉刷新",pulling:!1,scrollTop:0}),onShow(){this.getpage(1,this.currentTab)},computed:{...t(["auth/getUserInfo","auth/getLoginStatus"]),userInfo(){return this["auth/getUserInfo"]}},onReachBottom(){this.getpage(this.nextPage,this.currentTab)},onPullDownRefresh(){this.items=[],this.getpage(1),e()},methods:{ckeckList(t){let e=[];return this.items.forEach((a=>{a.checked&&e.push(a[t])})),e},buttonClick(t){if(0==t.index)this.isShowButton=!this.isShowButton;else{let t=this.ckeckList("item_id");0!=t.length?uni.$api.deleteHistory(this.$store,{ids:t},(async t=>{await this.getpage(1,this.currentTab),await this.$store.dispatch("auth/setUserInfo"),a({title:"删除成功",icon:"succee"})}),(t=>{a({title:"删除失败",icon:"error"})})):a({title:"未选择",icon:"error"})}},rarityColor:t=>({backgroundColor:uni.$api.getRarityColor[t]}),exteriorColor:t=>({color:uni.$api.getExteriorColor[t]}),qualityColor:t=>({color:uni.$api.getQualityColor[t]}),ToDetail(t){i({url:"/pages/details/details?item_id="+t})},timeformet:t=>uni.$tui.getCurrentDateTimeString(new Date(t)),async getpage(t){this.has_next||1==t?await uni.$api.MyGoodsList(this.$store,(e=>{e.data.length<this.pagesize?(this.no_more=!0,this.has_next=!1,this.items=1==t?e.data:this.items.concat(e.data)):(this.no_more=!1,1==t?(this.items=e.data,this.nextPage=2):(this.items=this.items.concat(e.data),this.nextPage++))}),(t=>{a({title:t.msg,icon:"error"})})):a({title:"没有更多啦~",icon:"error"})}}},[["render",function(t,e,a,i,k,T){const q=l,S=y,j=C(g("uni-tooltip"),x),B=_,D=C(g("tui-no-data"),w),L=C(g("tui-nomore"),b),P=C(g("tui-white-space"),$);return s(),o(q,{style:{}},{default:r((()=>[(s(!0),n(u,null,c(k.items,((t,e)=>(s(),o(B,{key:t.item_id,class:"card-list"},{default:r((()=>[d(q,{class:"card"},{default:r((()=>[d(q,{class:"card-main",onClick:e=>T.ToDetail(t.item_id)},{default:r((()=>[d(q,{class:"card-img"},{default:r((()=>[d(q,{class:"card-tags"},{default:r((()=>[t.rarity?(s(),o(q,{key:0,class:"card-tag-rarity",style:f(T.rarityColor(t.rarity))},null,8,["style"])):m("",!0),t.exterior?(s(),o(q,{key:1,class:"card-tag-exterior",style:f(T.exteriorColor(t.exterior))},{default:r((()=>[h(p(t.exterior),1)])),_:2},1032,["style"])):m("",!0),t.quality?(s(),o(q,{key:2,class:"card-tag-quality",style:f(T.qualityColor(t.quality))},{default:r((()=>[h(p(t.quality.split(" ")[0]),1)])),_:2},1032,["style"])):m("",!0)])),_:2},1024),d(S,{src:t.icon_url,alt:"加载中...",style:{width:"70%",height:"100%"}},null,8,["src"])])),_:2},1024),d(q,{class:"card-body"},{default:r((()=>[d(j,{content:t.name,placement:"bottom"},{default:r((()=>[d(q,{class:"card-title"},{default:r((()=>[h(p(t.name),1)])),_:2},1024)])),_:2},1032,["content"]),d(q,{class:"card-content"},{default:r((()=>[h(p(t.content),1)])),_:2},1024),d(q,{class:"card-time"},{default:r((()=>[h(p(T.timeformet(t.create_time)),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128)),0==k.items.length?(s(),o(q,{key:0},{default:r((()=>[d(D,{imgUrl:"/static/images/img_nodata.png"},{default:r((()=>[h("暂无数据")])),_:1})])),_:1})):m("",!0),k.no_more?(s(),o(L,{key:1,text:"NO MORE"})):m("",!0),d(P,{size:"large"})])),_:1})}]]);export{T as default};
