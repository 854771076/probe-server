import{B as t,C as e,s as a,n as i,o as s,c as o,w as r,i as l,a as n,d as c,r as u,F as d,u as h,v as m,b as g,e as p,g as f,h as _,t as y,W as C,f as k,X as x}from"./index-34a2c96b.js";import{_ as b,a as w}from"./uni-goods-nav.4075dcf5.js";import{_ as $,r as B}from"./uni-app.es.1c8f1c55.js";import{_ as S}from"./uni-tooltip.8e530bdf.js";import{_ as L,a as T}from"./tui-nomore.ef9d4a5b.js";import{_ as v}from"./tui-white-space.45e06eee.js";import"./uni-icons.0e843162.js";const j=$({data:()=>({isShowButton:!1,buttonGroup:[{text:"取消",backgroundColor:"#fff",color:"#000"},{text:"删除",backgroundColor:"#ff0000",color:"#fff"}],header:{line:!0,bgcolor:"#fff"},no_more:!1,menuList:[{title:"时间",type:"sort",value:"desc"},{title:"编辑",type:"click"}],items:[],has_next:!0,pagesize:20,nextPage:2,ordering:"-last_update",pullText:"下拉刷新",pulling:!1,scrollTop:0}),computed:{...t(["auth/getUserInfo","auth/getLoginStatus"]),userInfo(){return this["auth/getUserInfo"]}},onReachBottom(){this.getpage(this.nextPage,this.currentTab)},onPullDownRefresh(){this.items=[],this.getpage(1,this.currentTab),e()},onShow(){this.getpage(1,this.currentTab)},methods:{ckeckList(t){let e=[];return this.items.forEach((a=>{a.checked&&e.push(a[t])})),e},buttonClick(t){if(0==t.index)this.isShowButton=!this.isShowButton;else{let t=this.ckeckList("item_id");0!=t.length?uni.$api.deleteStar(this.$store,{ids:t},(async t=>{await this.getpage(1,this.currentTab),this.$store.dispatch("auth/setUserInfo"),a({title:"删除成功",icon:"succee"})}),(t=>{a({title:"删除失败",icon:"error"})})):a({title:"未选择",icon:"error"})}},onConfirm(t){"时间"===t.title?("-last_update"==this.ordering?this.ordering="last_update":this.ordering="-last_update",this.getpage(1,this.currentTab)):"编辑"===t.title&&(this.isShowButton=!this.isShowButton)},checkboxChange(t){for(var e=this.items,a=t.detail.value[0],i=0,s=e.length;i<s;++i){const t=e[i];a==t.item_id?this.$set(t,"checked",!0):t.checked||this.$set(t,"checked",!1)}},rarityColor:t=>({backgroundColor:uni.$api.getRarityColor[t]}),exteriorColor:t=>({color:uni.$api.getExteriorColor[t]}),qualityColor:t=>({color:uni.$api.getQualityColor[t]}),ToDetail(t){i({url:"/pages/details/details?item_id="+t})},timeformet:t=>uni.$tui.getCurrentDateTimeString(new Date(t)),async getpage(t){this.has_next||1==t?await uni.$api.starsList(this.$store,{page:t,ordering:this.ordering,pagesize:this.pagesize},(e=>{e.data.length<this.pagesize?(this.no_more=!0,this.has_next=!1,this.items=1==t?e.data:this.items.concat(e.data)):(this.no_more=!1,1==t?(this.items=e.data,this.nextPage=2):(this.items=this.items.concat(e.data),this.nextPage++))}),(t=>{a({title:"加载失败",icon:"error"})})):a({title:"没有更多啦~",icon:"error"})}}},[["render",function(t,e,a,i,$,j){const q=B(f("le-dropdown"),b),z=C,D=l,F=k,P=B(f("uni-tooltip"),S),U=x,G=B(f("uni-goods-nav"),w),I=B(f("tui-no-data"),L),O=B(f("tui-nomore"),T),R=B(f("tui-white-space"),v);return s(),o(D,{style:{}},{default:r((()=>[n(q,{menuList:$.menuList,"onUpdate:menuList":e[0]||(e[0]=t=>$.menuList=t),themeColor:"#eb652b",duration:300,isCeiling:!1,onOnConfirm:j.onConfirm},null,8,["menuList","onOnConfirm"]),(s(!0),c(d,null,u($.items,((t,e)=>(s(),o(U,{key:t.item_id,class:"card-list",onChange:j.checkboxChange},{default:r((()=>[n(D,{class:"card"},{default:r((()=>[h(n(D,{class:"card-radio"},{default:r((()=>[n(z,{value:t.item_id,color:"#FFCC33",style:{transform:"scale(0.7)"}},null,8,["value"])])),_:2},1536),[[m,$.isShowButton]]),n(D,{class:"card-main",onClick:e=>j.ToDetail(t.item_id)},{default:r((()=>[n(D,{class:"card-img"},{default:r((()=>[n(D,{class:"card-tags"},{default:r((()=>[t.rarity?(s(),o(D,{key:0,class:"card-tag-rarity",style:_(j.rarityColor(t.rarity))},null,8,["style"])):p("",!0),t.exterior?(s(),o(D,{key:1,class:"card-tag-exterior",style:_(j.exteriorColor(t.exterior))},{default:r((()=>[g(y(t.exterior),1)])),_:2},1032,["style"])):p("",!0),t.quality?(s(),o(D,{key:2,class:"card-tag-quality",style:_(j.qualityColor(t.quality))},{default:r((()=>[g(y(t.quality.split(" ")[0]),1)])),_:2},1032,["style"])):p("",!0)])),_:2},1024),t.price_rate>=0?(s(),o(D,{key:0,class:"card-price-rate",style:{color:"#15cc4a"}},{default:r((()=>[g(y(`${(100*t.price_rate).toFixed(2)}%`),1)])),_:2},1024)):(s(),o(D,{key:1,class:"card-price-rate",style:{color:"#ffbb00"}},{default:r((()=>[g(y(`${(100*t.price_rate).toFixed(2)}%`),1)])),_:2},1024)),n(F,{src:t.icon_url,alt:"加载中...",style:{width:"70%",height:"100%"}},null,8,["src"])])),_:2},1024),n(D,{class:"card-body"},{default:r((()=>[n(P,{content:t.name,placement:"bottom"},{default:r((()=>[n(D,{class:"card-title"},{default:r((()=>[g(y(t.name),1)])),_:2},1024)])),_:2},1032,["content"]),n(D,{class:"card-price"},{default:r((()=>[n(D,{class:"card-price-text"},{default:r((()=>[g("￥"+y(t.price),1)])),_:2},1024)])),_:2},1024),n(D,{class:"card-content"},{default:r((()=>[g(y(t.content),1)])),_:2},1024),n(D,{class:"card-time"},{default:r((()=>[g(y(j.timeformet(t.last_update)),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["onChange"])))),128)),h(n(G,{fill:!0,options:{},buttonGroup:$.buttonGroup,onButtonClick:j.buttonClick},null,8,["buttonGroup","onButtonClick"]),[[m,$.isShowButton]]),0==$.items.length?(s(),o(D,{key:0},{default:r((()=>[n(I,{imgUrl:"/static/images/img_nodata.png"},{default:r((()=>[g("暂无数据")])),_:1})])),_:1})):p("",!0),$.no_more?(s(),o(O,{key:1,text:"NO MORE"})):p("",!0),n(R,{size:"large"})])),_:1})}]]);export{j as default};
